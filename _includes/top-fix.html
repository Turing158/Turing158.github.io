<div id="top-fix">
    <div class="top-menu">
        {% if site.menu %}
        <ul id="menu" class="menu">
            {% for name_path in site.menu %}
            {% assign name = name_path[0] %}
            {% assign path = name_path[1] %}
            {% assign itemName = name | downcase %}
            <li class="menu-item menu-item-{{ itemName }}">
                <a href="{{ path | relative_url }}" rel="section">
                    {% if site.menu_icons.enable %}
                    <i class="menu-item-icon fa fa-fw fa-{{site.menu_icons[itemName] | default: 'question-circle' | downcase }}"></i> <br />
                    {% endif %}
                    {{ __.menu[name] }}
                </a>
            </li>
            {% endfor %}


            <li class="menu-item menu-item-search">
                {% if site.swiftype_key %}
                <a href="javascript:;" class="st-search-show-outputs">
                    {% elsif site.local_search.enable or site.algolia_search.enable %}
                    <a href="javascript:;" class="popup-trigger">
                        {% endif %}
                        {% if site.menu_icons.enable %}
                        <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
                        {% endif %}
                        {{ __.menu.search }}
                    </a>
                </a>
            </li>

        </ul>
        {% endif %}
    </div>
</div>
<script>
    const limitWidth = 768;
    const limitHeight = 370;
    const top_fixDOC = document.getElementById('top-fix');
    const bodyEle = document.querySelector('body');
    let windowWidth = window.innerWidth;
    let windowHeight = window.innerHeight;
    let timeOut = null;
    const observer = new MutationObserver(function(mutationsList) {
        for (let mutation of mutationsList) {
            if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                const computedStyle = window.getComputedStyle(bodyEle);
                top_fixDOC.style.paddingRight = computedStyle.getPropertyValue('padding-right');
            }
        }
    });
    observer.observe(bodyEle, { attributes: true });
    checkWindowWidth();
    window.addEventListener('resize', function() {
        windowWidth = window.innerWidth;
        windowHeight = window.innerHeight;
        checkWindowWidth();
    });
    function checkWindowWidth(){
        if(windowWidth >= limitWidth){
            let nowScrollY = window.scrollY || window.pageYOffset;
            if(nowScrollY >= limitHeight){
                showTopFixDOC();
            }
            window.addEventListener('scroll',scrollFun);
            observer.observe(bodyEle, { attributes: true });
        }
        else{
            window.removeEventListener('scroll',scrollFun);
            hideTopFixDOC();
            observer.disconnect();
        }
    }
    function scrollFun(){
        const scrollY = window.scrollY || window.pageYOffset;
        if (scrollY >= limitHeight) {
            showTopFixDOC();
        } else {
            hideTopFixDOC();
        }
    }
    function showTopFixDOC(){
        top_fixDOC.style.display = 'block';
        top_fixDOC.style.animation = 'show 0.15s ease-out';
        clearTimeout(timeOut);
    }
    function hideTopFixDOC(){
        top_fixDOC.style.display = 'none';
    }

</script>
<style>
    #top-fix{
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 55px;
        z-index: 999;
        background-color: #f1f1f1aa;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        backdrop-filter: blur(10px);
        display: none;
    }
    .top-menu{
        position: relative;
        top: -20px;
    }
    @keyframes show  {
        0%{
            opacity: 0;
        }
        100%{
            opacity: 1;
        }
    }
</style>